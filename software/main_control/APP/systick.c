#include "systick.h"
/*
**************************************
						变量声明
**************************************
*/
u32 SysTick_1ms = 0, SysTick_100us = 0;
/*
*********************************************************************************************************
*	函 数 名: SysTick_Init
*	功能说明: 滴答定时器初始化，100us进入一次滴答定时器中断
*	形    参: 无
*	返 回 值: 无
*********************************************************************************************************
*/   //Cnt = 168M/1K = 168K, 时间 = 168K/168M = 1/1K = 1ms
void SysTick_Init(void)
{    //同理Cnt = 168M/10K = 16.8K, 时间 = 16.8K/168M = 1/10K = 100us

    if(SysTick_Config(SystemCoreClock/10000))//
    {
        while(1);
    }
}
/*
*********************************************************************************************************
*	函 数 名: SysTick_Handler
*	功能说明: 滴答定时器中断，100us进入一次中断
*	形    参: 无
*	返 回 值: 无
*********************************************************************************************************
*/ 
void SysTick_Handler()
{
    static u8 temp = 0;
    SysTick_100us++;
    if(++temp >= 10)
    {
        temp = 0;
        SysTick_1ms++;
    }
}
/*
*********************************************************************************************************
*	函 数 名: delay_ms
*	功能说明: 毫秒级延迟，用于中断的话要提高滴答定时器的中断优先级
*	形    参: 无
*	返 回 值: 无
*********************************************************************************************************
*/ 
void delay_ms(u32 ms)
{
    u32 mytemp = SysTick_1ms;
    while(SysTick_1ms - mytemp < ms);   
}


